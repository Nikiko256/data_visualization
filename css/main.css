/* =======================
   Stations â€” UI/UX Glow-up
   ======================= */

/* 1) Design tokens */
:root{
  --bg: #0b1020;
  --bg-2: #10162e;
  --card: rgba(255,255,255,0.08);
  --text: #e8ecf3;
  --muted: #b6c2e1;
  --accent: #6ee7f9;  /* cyan */
  --accent-2:#a78bfa; /* violet */
  --ring: 0 0 0 3px color-mix(in oklab, var(--accent) 30%, transparent);
  --radius: 14px;
  --shadow-lg: 0 10px 30px rgba(0,0,0,.35);
  --shadow-sm: 0 4px 14px rgba(0,0,0,.25);
  --blur: 14px;
  --transition: 220ms cubic-bezier(.22,.61,.36,1);
}

@media (prefers-color-scheme: light){
  :root{
    --bg: #f5f7fa;
    --bg-2:#eef2f8;
    --card: rgba(255,255,255,0.7);
    --text:#1b2333;
    --muted:#5a6b8a;
    --shadow-lg: 0 10px 30px rgba(17, 24, 39, .10);
    --shadow-sm: 0 6px 16px rgba(17, 24, 39, .08);
  }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  * { animation: none !important; transition: none !important; }
}

/* 2) Reset + base */
*{ box-sizing: border-box; }
html,body{ height:100%; }
body{
  margin:0;
  font: 500 16px/1.55 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
  color: var(--text);
  background:
    radial-gradient(1200px 700px at 10% -10%, color-mix(in oklab, var(--accent) 12%, transparent), transparent 60%),
    radial-gradient(1200px 700px at 90% 110%, color-mix(in oklab, var(--accent-2) 16%, transparent), transparent 60%),
    linear-gradient(180deg, var(--bg) 0%, var(--bg-2) 100%);
  padding: clamp(16px, 3vw, 32px);
}

/* Subtle floating particles (very light) */
@keyframes particleFloat {
  from { transform: translateY(0px) }
  to   { transform: translateY(-10px) }
}
body::before, body::after{
  content:"";
  position:fixed; inset:0; pointer-events:none;
  background:
    radial-gradient(1px 1px at 20% 30%, rgba(255,255,255,.12), transparent 40%),
    radial-gradient(1.2px 1.2px at 80% 70%, rgba(255,255,255,.10), transparent 40%),
    radial-gradient(0.8px 0.8px at 60% 20%, rgba(255,255,255,.10), transparent 40%);
  mix-blend-mode: screen; opacity:.35;
  animation: particleFloat 6s ease-in-out alternate infinite;
}

/* 3) Container (glass card) */
.container{
  /* was 920px */
  max-width: min(1400px, 96vw);
  margin-inline: auto;
  border-radius: var(--radius);
  background: var(--card);
  backdrop-filter: blur(var(--blur));
  -webkit-backdrop-filter: blur(var(--blur));
  box-shadow: var(--shadow-lg);
  overflow: clip;
  border: 1px solid rgba(255,255,255,.12);
}


/* 4) Header */
header{
  position: static;              /* no separate sticky here */
  background: var(--panel-bg, #0f1426);
  padding: clamp(18px, 2.6vw, 28px);
  border-bottom: 1px solid rgba(255,255,255,.16);
  text-align: center;
  /* kill blur to avoid shimmer/jitter */
  -webkit-backdrop-filter: none;
  backdrop-filter: none;
  z-index: 1;
}
header h1{
  margin:0;
  font-weight: 700;
  letter-spacing: .3px;
  font-size: clamp(20px, 2.4vw, 30px);
  background: linear-gradient(90deg, var(--accent), var(--accent-2));
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
}

/* 5) Search box */
.search-box{
  padding: clamp(12px, 2vw, 20px);
  border-bottom: 1px solid rgba(255,255,255,.08);
  background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,0));
}
.search-box input{
  width: 100%;
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.06);
  color: var(--text);
  padding: 12px 44px 12px 14px;
  border-radius: 12px;
  outline: none;
  transition: border-color var(--transition), box-shadow var(--transition), background var(--transition);
  box-shadow: var(--shadow-sm) inset;
}
.search-box input::placeholder{ color: color-mix(in oklab, var(--muted) 75%, #fff 0%); }
.search-box input:focus{
  border-color: color-mix(in oklab, var(--accent) 55%, #fff 0%);
  box-shadow: var(--ring);
  background: rgba(255,255,255,.09);
}

/* Optional: search icon without extra markup */
.search-box{ position: relative; }
.search-box::after{
  content: "ðŸ”Ž";
  position: absolute; right: clamp(18px, 2vw, 22px); top: 50%; transform: translateY(-50%);
  opacity: .75; font-size: 18px; pointer-events:none;
}

/* 6) List */
.stations-list{
  list-style: none; margin:0; padding: 4px;
  display: grid; gap: 10px;
  grid-template-columns: 1fr;
}
@container (min-width: 680px){
  .stations-list{ grid-template-columns: 1fr; }
}

/* List item (as cards) */
.station-item{
  --bgItem: rgba(255,255,255,.06);
  position: relative;
  padding: 16px 18px;
  background: var(--bgItem);
  border: 1px solid rgba(255,255,255,.10);
  border-radius: 12px;
  cursor: pointer;
  transition: transform var(--transition), background var(--transition), border-color var(--transition), box-shadow var(--transition);
  box-shadow: var(--shadow-sm);
  will-change: transform;
}
.station-item:hover{
  transform: translateY(-2px);
  background: rgba(255,255,255,.10);
  border-color: color-mix(in oklab, var(--accent) 28%, rgba(255,255,255,.10));
}
.station-item:active{ transform: translateY(0); }

/* Micro-glow on hover */
.station-item::after{
  content:"";
  position:absolute; inset:-1px;
  border-radius: inherit;
  opacity:0;
  transition: opacity var(--transition);
  background:
    radial-gradient(240px 140px at var(--mx,50%) var(--my,50%), color-mix(in oklab, var(--accent) 25%, transparent) 0%, transparent 60%),
    radial-gradient(240px 140px at var(--mx,50%) var(--my,50%), color-mix(in oklab, var(--accent-2) 25%, transparent) 0%, transparent 60%);
  pointer-events:none;
}
.station-item:hover::after{ opacity:.7; }

/* JS can set CSS variables on mousemove for parallax glow:
   el.style.setProperty('--mx', e.offsetX+'px'); etc. */

/* Title + meta inside items (optional classes) */
.station-title{
  font-weight: 650; letter-spacing:.2px;
  font-size: 1.05rem;
}
.station-meta{
  margin-top: 6px;
  font-size: .9rem; color: var(--muted);
}

/* 7) Empty state */
.empty{
  padding: 28px; text-align:center; color: var(--muted);
}

/* 8) Focus ring for keyboard access */
.station-item:focus-visible,
button:focus-visible,
input:focus-visible{
  outline: none;
  box-shadow: var(--ring);
}

/* 9) Subtle scrollbar style */
*{
  scrollbar-width: thin;
  scrollbar-color: color-mix(in oklab, var(--accent) 45%, #777) transparent;
}
*::-webkit-scrollbar{ height:10px; width:10px; }
*::-webkit-scrollbar-thumb{
  background: linear-gradient(180deg, var(--accent), var(--accent-2));
  border-radius: 999px;
}
*::-webkit-scrollbar-track{ background: transparent; }

/* 10) Utility: skeleton (use while loading) */
.skeleton{
  position: relative; overflow: hidden; background: rgba(255,255,255,.06);
}
.skeleton::after{
  content:""; position:absolute; inset:0;
  background: linear-gradient(100deg, transparent 20%, rgba(255,255,255,.18) 40%, transparent 60%);
  animation: shimmer 1.4s infinite;
}
@keyframes shimmer{
  from{ transform: translateX(-100%) }
  to{ transform: translateX(100%) }
}






/* =======================
   Station Details â€” Additions
   ======================= */

/* Controls bar */
.controls{
  display: grid;
  grid-template-columns: 1fr auto;
  align-items: center;
  gap: 12px;
  padding: clamp(12px, 2vw, 18px);
  border-bottom: 1px solid rgba(255,255,255,.16);
  background: var(--panel-bg, #0f1426);
  -webkit-backdrop-filter: none;
  backdrop-filter: none;
  position: static; /* important: no sticky here */
}
.controls label{
  color: var(--muted);
  font-size: .95rem;
}

/* Select (same vibe as your inputs) */
#nodeSelect{
  appearance: none;
  -webkit-appearance: none;
  border: 1px solid rgba(255,255,255,.18);
  background:
    rgba(255,255,255,.06)
    linear-gradient(180deg, transparent 60%, rgba(0,0,0,.02)),
    /* caret */
    linear-gradient(90deg, transparent calc(100% - 34px), rgba(255,255,255,.06) 0);
  color: var(--text);
  padding: 12px 40px 12px 12px;
  border-radius: 12px;
  outline: none;
  transition: border-color var(--transition), box-shadow var(--transition), background var(--transition);
  box-shadow: var(--shadow-sm) inset;
  cursor: pointer;
  min-width: 140px;
  position: relative;
}
#nodeSelect:focus{
  border-color: color-mix(in oklab, var(--accent) 55%, #fff 0%);
  box-shadow: var(--ring);
  background: rgba(255,255,255,.09);
}
/* caret icon */
#nodeSelect{
  background-image:
    linear-gradient(180deg, transparent 60%, rgba(0,0,0,.02)),
    radial-gradient(6px 6px at calc(100% - 18px) 50%, var(--muted) 99%, transparent 100%);
  background-repeat: no-repeat, no-repeat;
  background-position: 0 0, right 12px center;
}

/* Charts layout */
.charts-container{
  display: grid;
  gap: 16px; /* a bit roomier */
  padding: clamp(12px, 2vw, 20px);
  grid-template-columns: 1fr;      /* mobile: 1 column */
}

@media (min-width: 900px){
  .charts-container{ grid-template-columns: 1fr 1fr; } /* desktop: ~2 columns */
}

/* keep it at two columns even on ultra-wide to match your request */
@media (min-width: 1400px){
  .charts-container{ grid-template-columns: 1fr 1fr; }
}


/* Chart card */
.chart-card{
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.10);
  border-radius: 16px;           /* slightly larger */
  box-shadow: var(--shadow-sm);
  padding: 14px;                 /* a hair more breathing room */
  transition: transform var(--transition), border-color var(--transition), background var(--transition), box-shadow var(--transition);
  position: relative;
  overflow: clip;
}
.chart-card:hover{
  transform: translateY(-2px);
  border-color: color-mix(in oklab, var(--accent) 28%, rgba(255,255,255,.10));
  background: rgba(255,255,255,.10);
}

/* Card header (title + range select) */
.chart-head{
  display: grid;
  grid-template-columns: 1fr auto;
  align-items: center;
  gap: 10px;
  padding: 6px 6px 10px;
}
/* Slightly larger titles on wider screens */
.chart-title{
  font-weight: 650;
  font-size: clamp(1rem, 1.1vw, 1.15rem);
  letter-spacing: .2px;
}
.time-select{
  appearance: none;
  -webkit-appearance: none;
  font-size: .92rem;
  border: 1px solid rgba(255,255,255,.18);
  background:
    rgba(255,255,255,.06)
    linear-gradient(180deg, transparent 60%, rgba(0,0,0,.02));
  color: var(--text);
  padding: 8px 34px 8px 10px;
  border-radius: 10px;
  outline: none;
  transition: border-color var(--transition), box-shadow var(--transition), background var(--transition);
  box-shadow: var(--shadow-sm) inset;
  cursor: pointer;
  min-width: 120px;
  background-image:
    radial-gradient(5px 5px at calc(100% - 16px) 50%, var(--muted) 99%, transparent 100%);
  background-repeat: no-repeat;
  background-position: right 10px center;
}
.time-select:focus{
  border-color: color-mix(in oklab, var(--accent) 55%, #fff 0%);
  box-shadow: var(--ring);
  background: rgba(255,255,255,.09);
}

/* Canvas box */
.chart-canvas{
  width: 100% !important;
  aspect-ratio: 16/9;
  display: block;
  border-radius: 10px;
  background: rgba(255,255,255,.04);
  padding: 20px;
}

/* Loading state you can toggle while data arrives */
.chart-skeleton{
  position: relative;
  border-radius: 10px;
  overflow: hidden;
  background: rgba(255,255,255,.06);
  height: 240px;
}
.chart-skeleton::after{
  content:""; position:absolute; inset:0;
  background: linear-gradient(100deg, transparent 20%, rgba(255,255,255,.18) 40%, transparent 60%);
  animation: shimmer 1.4s infinite;
}

/* Optional: compact legend area (if you render your own) */
.chart-legend{
  display:flex; flex-wrap:wrap; gap:10px; margin-top:10px; font-size:.9rem; color:var(--muted);
}
.chart-legend .dot{
  width:10px; height:10px; border-radius:50%; margin-right:6px; display:inline-block;
}

/* Tooltip helper (if you make custom HTML tooltips) */
.tooltip{
  position: absolute; z-index: 10; pointer-events: none;
  background: rgba(17, 24, 39, .9);
  color: white; font-size: .85rem;
  padding: 6px 10px; border-radius: 8px;
  border: 1px solid rgba(255,255,255,.12);
  box-shadow: var(--shadow-sm);
}

/* Small header tweak to fit detail pages with long names */
#stationTitle{
  word-break: break-word;
  line-height: 1.2;
}

/* Station Details â€“ chart sizing guard */
.chart-box{
  position: relative;
  width: 100%;
  /* responsive height: grows with viewport width but stays in a nice range */
  height: clamp(280px, 34vw, 420px);
}

.chart-canvas{
  width: 100% !important;
  height: 100% !important;  /* fills the box; prevents resize loop */
  display: block;
}



/* Expand button inside chart head */
.chart-head {
  position: relative;
}
.expand-btn{
  appearance: none;
  -webkit-appearance: none;
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.06);
  color: var(--text);
  padding: 6px 10px;
  border-radius: 10px;
  cursor: pointer;
  box-shadow: var(--shadow-sm) inset;
  transition: transform var(--transition), background var(--transition), border-color var(--transition), box-shadow var(--transition);
  margin-left: 6px;
}
.expand-btn:hover{
  background: rgba(255,255,255,.10);
  border-color: color-mix(in oklab, var(--accent) 28%, rgba(255,255,255,.10));
  transform: translateY(-1px);
}
.expand-btn:focus-visible{ box-shadow: var(--ring); outline: none; }

/* Modal */
.modal{
  position: fixed; inset: 0; z-index: 50;
  display: none;
}
.modal.open{ display: block; }
.modal-backdrop{
  position: absolute; inset: 0;
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(4px);
}
.modal-dialog{
  position: relative;
  margin: 4vh auto;
  width: min(1200px, 94vw);
  background: var(--card);
  border: 1px solid rgba(255,255,255,.14);
  box-shadow: var(--shadow-lg);
  border-radius: 16px;
  overflow: clip;
  display: flex;
  flex-direction: column;
  max-height: 92vh;
}
.modal-close{
  position: absolute; top: 6px; right: 6px;
  width: 36px; height: 36px; line-height: 34px; text-align: center;
  border-radius: 8px; font-size: 22px; border: 1px solid rgba(255,255,255,.18);
  background: rgba(0, 0, 0, 1); color: var(--text);
  cursor: pointer;
}
.modal-close:hover{ background: rgba(255,255,255,.12); }
.modal-body{
  padding: clamp(12px, 2vw, 18px);
}

/* Larger chart inside modal */
.modal-body .chart-card{ border-radius: 16px; }
.modal-body .chart-box{
  height: clamp(360px, 60vh, 720px); /* Bigger for readability */
}

.modal-body {
  background-color: var(--panel-bg, #0f1426);
  flex: 1 1 auto;
  overflow: auto;
  padding: clamp(12px, 2vw, 18px);
}

.modal-footer{
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  padding: 12px 16px;
  border-top: 1px solid rgba(255,255,255,.14);
  background-color: var(--panel-bg, #0f1426);
}


/* Simple button style that matches your theme */
.btn{
  appearance: none;
  -webkit-appearance: none;
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.08);
  color: var(--text);
  padding: 10px 14px;
  border-radius: 12px;
  cursor: pointer;
  box-shadow: var(--shadow-sm);
  transition: transform var(--transition), background var(--transition), border-color var(--transition), box-shadow var(--transition);
}
.btn:hover{
  background: rgba(255,255,255,.12);
  border-color: color-mix(in oklab, var(--accent) 28%, rgba(255,255,255,.10));
  transform: translateY(-1px);
}
.btn:focus-visible{ outline: none; box-shadow: var(--ring); }

/* Disable hover-lift for chart card INSIDE the modal only */
.modal-body .chart-card:hover{
  transform: none;
}


/* ==== Minimal custom dropdown (dark) ==== */
.dd { position: relative; display: inline-block; }
.dd__native {
  /* keep the real <select> in DOM, but visually hidden */
  position: absolute; width:1px; height:1px; padding:0; margin:-1px; border:0;
  clip: rect(0 0 0 0); clip-path: inset(50%); overflow: hidden; white-space: nowrap;
}
.dd__btn{
  border: 1px solid rgba(255,255,255,.18);
  background:
    rgba(255,255,255,.06)
    linear-gradient(180deg, transparent 60%, rgba(0,0,0,.02));
  color: var(--text);
  border-radius: 12px;
  box-shadow: var(--shadow-sm) inset;
  cursor: pointer;
  transition: border-color var(--transition), box-shadow var(--transition), background var(--transition);
  background-image: radial-gradient(5px 5px at calc(100% - 16px) 50%, var(--muted) 99%, transparent 100%);
  background-repeat: no-repeat; background-position: right 10px center;
}
.dd__btn:focus-visible{ outline: none; box-shadow: var(--ring); }

/* sizing variants to match your existing selects */
.dd__btn--node { padding: 12px 40px 12px 12px; min-width: 140px; }
.dd__btn--time { padding:  8px 34px  8px 10px; min-width: 120px; border-radius: 10px; }

/* the popup menu is PORTALLED to <body> and positioned with JS */
.dd__menu{
  position: fixed;
  display: none;
  min-width: 160px;
  max-height: 280px; overflow: auto;
  background: rgba(15,20,38,.98); /* matches your panel bg */
  border: 1px solid rgba(255,255,255,.14);
  border-radius: 12px;
  box-shadow: var(--shadow-lg);
  padding: 6px;
  z-index: 100; /* above charts/cards */
}
.dd--open .dd__menu{ display: block; }

.dd__option{
  padding: 8px 10px;
  border-radius: 8px;
  cursor: pointer;
  color: var(--text);
  user-select: none;
  white-space: nowrap;
}
.dd__option:hover{ background: rgba(255,255,255,.10); }
.dd__option[aria-selected="true"]{
  outline: 2px solid color-mix(in oklab, var(--accent) 60%, transparent);
  outline-offset: 2px;
}
.dd__option[aria-disabled="true"]{ opacity:.5; pointer-events:none; }



/* ==== Wind Direction card ==== */
.wind-card .wind-box{
  display: grid;
  gap: 10px;
}

.wind-rose{
  /* 3x3 grid ring with a center */
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-template-rows: repeat(3, 1fr);
  gap: 10px;
  height: clamp(240px, 28vw, 360px);
  align-items: center;
  justify-items: center;
  border-radius: 12px;
  background: rgba(255,255,255,.04);
  position: relative;
  padding: 12px;
}

/* positions */
.pos-N  { grid-area: 1 / 2; }
.pos-NE { grid-area: 1 / 3; }
.pos-E  { grid-area: 2 / 3; }
.pos-SE { grid-area: 3 / 3; }
.pos-S  { grid-area: 3 / 2; }
.pos-SW { grid-area: 3 / 1; }
.pos-W  { grid-area: 2 / 1; }
.pos-NW { grid-area: 1 / 1; }

/* arrow look */
.wind-arrow{
  font-size: clamp(22px, 3.2vw, 30px);
  line-height: 1;
  color: color-mix(in oklab, var(--muted) 60%, #fff 0%);
  opacity: .35;
  transition: transform var(--transition), color var(--transition), opacity var(--transition), text-shadow var(--transition);
  user-select: none;
}
.wind-arrow.active{
  opacity: 1;
  color: var(--accent);
  text-shadow: 0 0 14px color-mix(in oklab, var(--accent) 60%, transparent);
  transform: scale(1.15);
}

/* center dot */
.wind-center{
  grid-area: 2 / 2;
  width: 14px; height: 14px; border-radius: 999px;
  background: radial-gradient(circle, rgba(255,255,255,.85), rgba(255,255,255,.12));
  border: 1px solid rgba(255,255,255,.25);
  box-shadow: 0 0 10px rgba(255,255,255,.3) inset;
}

/* text below the rose */
.wind-meta{
  font-size: .95rem;
  color: var(--muted);
}

/* Bigger in modal */
.modal-body .wind-rose{
  height: clamp(360px, 60vh, 720px);
}
